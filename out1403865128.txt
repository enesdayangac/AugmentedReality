hello world
=========================== Baseline triangulation ===========================
Find camera matrices...
before fundamentalMat 22716
F keeping 16736 / 22716
22716 matches before, 16736 new matches after Fundamental Matrix
after fundamentalMat 16736
K
[1024, 0, 512;
  0, 1024, 384;
  0, 0, 1]
F
[4.632165911368509e-006, -8.358559724233219e-005, 0.06152381317746108;
  8.394277329641669e-005, 1.582802161605156e-005, 0.1177062560084166;
  -0.05438649211421709, -0.1288382524989112, 1]
det(F)
-2.40346e-020
E
[4.857178002679146, -87.64585121397572, 32.56177948981883;
  88.02037745206343, 16.59688359407288, 170.7652262264276;
  -20.25553737909494, -169.5294648180956, 3.998076657758702]
----------------------- SVD ------------------------
U:
[-0.1491513366456798, 0.4676155537247099, -0.8712574663620049;
  0.8200762490976477, 0.5507978570209173, 0.1552310096826601;
  -0.5524751799336692, 0.6913446424294456, 0.4656326459145254]
W:
[197.4740723383525; 190.0525305903919; 7.026131613156182e-013]
Vt:
[0.418534175515347, 0.6094168518375855, 0.6733797180061598;
  0.1933632238166173, -0.7842375058262575, 0.5895610215496405;
  0.887378052242072, -0.1165445629438689, -0.4460690050286941]
----------------------------------------------------
singular value ratio: 0.962418
det(R) == -1 [-1]: flip E's sign
----------------------- SVD ------------------------
U:
[0.1491513366456798, -0.4676155537247099, 0.8712574663620049;
  -0.8200762490976477, -0.5507978570209173, -0.1552310096826601;
  0.5524751799336692, -0.6913446424294456, -0.4656326459145254]
W:
[197.4740723383525; 190.0525305903919; 7.026131613156182e-013]
Vt:
[0.418534175515347, 0.6094168518375855, 0.6733797180061598;
  0.1933632238166173, -0.7842375058262575, 0.5895610215496405;
  0.887378052242072, -0.1165445629438689, -0.4460690050286941]
----------------------------------------------------
singular value ratio: 0.962418
P
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
Testing P1 
[0.5485812799749884, -0.269543047008284, -0.7914575952446812, 0.8712574663620049;
  -0.2097037306826783, -0.9607087180254668, 0.1818326275662079, -0.1552310096826601;
  -0.8093719321787543, 0.06622163482846522, -0.5835510007547544, -0.4656326459145254]
test branch 1
Triangulating...Done. (16736points, 1.49052s, mean reproj err = 8.43665)
Triangulating...Done. (16736points, 1.47383s, mean reproj err = 8.40363)
0/16736 = 0% are in front of camera
P
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
Testing P1 
[0.5485812799749884, -0.269543047008284, -0.7914575952446812, -0.8712574663620049;
  -0.2097037306826783, -0.9607087180254668, 0.1818326275662079, 0.1552310096826601;
  -0.8093719321787543, 0.06622163482846522, -0.5835510007547544, 0.4656326459145254]
test branch 2
Triangulating...Done. (16736points, 1.41619s, mean reproj err = 8.43665)
Triangulating...Done. (16736points, 1.41159s, mean reproj err = 8.40363)
16736/16736 = 100% are in front of camera
0/16736 = 0% are in front of camera
P
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
Testing P1 
[0.9976882270283686, 0.06646240575079918, 0.01417569295684029, 0.8712574663620049;
  -0.06579345135685993, 0.9968913783830689, -0.0433451434887204, -0.1552310096826601;
  -0.0170124486051535, 0.04231227159254603, 0.9989595828986955, -0.4656326459145254]
test branch 3
Triangulating...Done. (16736points, 1.42817s, mean reproj err = 26.275)
Triangulating...Done. (16736points, 1.41793s, mean reproj err = 26.3754)
14644/16736 = 87.5% are in front of camera
14654/16736 = 87.5598% are in front of camera
Done. (11.517s)
begin triangulation
p query index 1
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
p train index 0
[0.9976882270283686, 0.06646240575079918, 0.01417569295684029, 0.8712574663620049;
  -0.06579345135685993, 0.9968913783830689, -0.0433451434887204, -0.1552310096826601;
  -0.0170124486051535, 0.04231227159254603, 0.9989595828986955, -0.4656326459145254]
getalign
triangulate points
Triangulating...Done. (16736points, 1.47492s, mean reproj err = 26.275)
triangulation reproj error 26.275
test triangulate
14654/16736 = 87.5598% are in front of camera
14644/16736 = 87.5% are in front of camera
filtered out 9674 high-error points
1577/7062 points were found in other views, adding 5485 new
 after 5485
after init map size: 5485
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 22297
train frame keypoints: 22716
match size: 22297-----------------------------------------------------------------
found 8315 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 8315
2d point: 8315
inliers size: 5870
projected point: 8315
--------------------------------------------------------------------------
(5870/8315)
found t = [0.8056252747177823; -0.2798936534867584; 0.2243650648962756]
R = 
[0.9986348871582904, 0.03713179831413804, -0.0367367895209522;
  -0.03810581154084582, 0.998930756841575, -0.02617804734375426;
  0.03572547098586819, 0.02754219653325554, 0.9989820409461631]
frame pose [0.9986348871582904, 0.03713179831413804, -0.0367367895209522, 0.8056252747177823;
  -0.03810581154084582, 0.998930756841575, -0.02617804734375426, -0.2798936534867584;
  0.03572547098586819, 0.02754219653325554, 0.9989820409461631, 0.2243650648962756]
next to triangulate ,inliers size: 5870
match size: 22297
match size: 5870
begin triangulation
p query index 2
[0.9986348871582904, 0.03713179831413804, -0.0367367895209522, 0.8056252747177823;
  -0.03810581154084582, 0.998930756841575, -0.02617804734375426, -0.2798936534867584;
  0.03572547098586819, 0.02754219653325554, 0.9989820409461631, 0.2243650648962756]
p train index 1
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
getalign
triangulate points
Triangulating...Done. (5870points, 0.523464s, mean reproj err = 11.239)
triangulation reproj error 11.239
test triangulate
5837/5870 = 99.4378% are in front of camera
5835/5870 = 99.4037% are in front of camera
filtered out 109 high-error points
2220/5761 points were found in other views, adding 3541 new
before triangulation: 9026 after 9026
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 5761 K (measurements) = 11522
intrinsic before bundle = [ 1024 0 512 
0 1024 384 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 11522 valid 2D measurements.
mean reprojection error (in pixels): 5.12232
K0 = [ 1 0 0.5 
0 1 0.375 
0 0 1 ]
optimizer status = 0
refined K = [ 1.03245 0 0.447447 
0 1.03245 0.2923 
0 0 1 ]
Knew = [ 1057.23 0 458.185 
0 1057.23 299.315 
0 0 1 ]
mean reprojection error (in pixels): 0.972761
use new K 
[1057.230865304612, 0, 458.1853130838379;
  0, 1057.230865304612, 299.3150956996478;
  0, 0, 1]
after 2 map size: 9026
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 20753
train frame keypoints: 22297
match size: 20753-----------------------------------------------------------------
found 7548 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 7548
2d point: 7548
inliers size: 944
projected point: 7548
--------------------------------------------------------------------------
(944/7548)
not enough inliers to consider a good pose (944/7548)
lost a frame
after 3 map size: 9026
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 22771
train frame keypoints: 22297
match size: 22771-----------------------------------------------------------------
found 8235 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 8235
2d point: 8235
inliers size: 4654
projected point: 8235
--------------------------------------------------------------------------
(4654/8235)
found t = [2.475925915256537; 2.679807312442779; 0.07212792349921315]
R = 
[0.9981841724573441, 0.04166967064554344, -0.04349708500507913;
  -0.04402673576579589, 0.9975308251424528, -0.05471653706536948;
  0.04110966301802938, 0.05653221593842841, 0.99755406077447]
frame pose [0.9981841724573441, 0.04166967064554344, -0.04349708500507913, 2.475925915256537;
  -0.04402673576579589, 0.9975308251424528, -0.05471653706536948, 2.679807312442779;
  0.04110966301802938, 0.05653221593842841, 0.99755406077447, 0.07212792349921315]
next to triangulate ,inliers size: 4654
match size: 22771
match size: 4654
begin triangulation
p query index 3
[0.9981841724573441, 0.04166967064554344, -0.04349708500507913, 2.475925915256537;
  -0.04402673576579589, 0.9975308251424528, -0.05471653706536948, 2.679807312442779;
  0.04110966301802938, 0.05653221593842841, 0.99755406077447, 0.07212792349921315]
p train index 2
[0.9994025104997227, 0.03353327989571944, -0.008375031121540219, 1.408852637419378;
  -0.03384071226516711, 0.9986362727045213, -0.03975425803871809, 2.856048662604761;
  0.00703051920114029, 0.04001392230534445, 0.999174388093242, -0.03427059665837323]
getalign
triangulate points
Triangulating...Done. (4654points, 0.414246s, mean reproj err = 25.6555)
triangulation reproj error 25.6555
test triangulate
4570/4654 = 98.1951% are in front of camera
4570/4654 = 98.1951% are in front of camera
filtered out 320 high-error points
3750/4334 points were found in other views, adding 584 new
before triangulation: 9610 after 9610
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 4334 K (measurements) = 8668
intrinsic before bundle = [ 1057.23 0 458.185 
0 1057.23 299.315 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 8668 valid 2D measurements.
mean reprojection error (in pixels): 2.40551
K0 = [ 1 0 0.433382 
0 1 0.283112 
0 0 1 ]
optimizer status = 0
refined K = [ 1.10552 0 0.364263 
0 1.10552 0.211834 
0 0 1 ]
Knew = [ 1168.79 0 385.11 
0 1168.79 223.958 
0 0 1 ]
mean reprojection error (in pixels): 0.608163
use new K 
[1168.793587522712, 0, 385.1096302313501;
  0, 1168.793587522712, 223.95771633807;
  0, 0, 1]
after 4 map size: 9610
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 22343
train frame keypoints: 22771
match size: 22343-----------------------------------------------------------------
found 5965 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 5965
2d point: 5965
inliers size: 4054
projected point: 5965
--------------------------------------------------------------------------
(4054/5965)
found t = [3.853145967325777; 5.834623442119488; -2.44014228134111]
R = 
[0.9962838726788917, 0.07760688262690209, -0.03735795509505489;
  -0.07992527062108719, 0.9946670961670651, -0.06518680018780225;
  0.03209978436213978, 0.06793040240947142, 0.9971735376916053]
frame pose [0.9962838726788917, 0.07760688262690209, -0.03735795509505489, 3.853145967325777;
  -0.07992527062108719, 0.9946670961670651, -0.06518680018780225, 5.834623442119488;
  0.03209978436213978, 0.06793040240947142, 0.9971735376916053, -2.44014228134111]
next to triangulate ,inliers size: 4054
match size: 22343
match size: 4054
begin triangulation
p query index 4
[0.9962838726788917, 0.07760688262690209, -0.03735795509505489, 3.853145967325777;
  -0.07992527062108719, 0.9946670961670651, -0.06518680018780225, 5.834623442119488;
  0.03209978436213978, 0.06793040240947142, 0.9971735376916053, -2.44014228134111]
p train index 3
[0.9981060248156178, 0.05757536379311407, -0.02166658050673622, 3.239635491915034;
  -0.05928610145212182, 0.994264100148381, -0.08901717435831189, 5.998393957280753;
  0.01641710697330765, 0.09013310512913639, 0.9957944074749603, -2.910116603589941]
getalign
triangulate points
Triangulating...Done. (4054points, 0.362087s, mean reproj err = 88.1551)
triangulation reproj error 88.1551
test triangulate
4029/4054 = 99.3833% are in front of camera
3993/4054 = 98.4953% are in front of camera
filtered out 129 high-error points
2812/3925 points were found in other views, adding 1113 new
before triangulation: 10723 after 10723
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 3925 K (measurements) = 7850
intrinsic before bundle = [ 1168.79 0 385.11 
0 1168.79 223.958 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 7850 valid 2D measurements.
mean reprojection error (in pixels): 1.49943
K0 = [ 1 0 0.329493 
0 1 0.191614 
0 0 1 ]
optimizer status = 0
refined K = [ 1.04909 0 0.312143 
0 1.04909 0.249653 
0 0 1 ]
Knew = [ 1226.17 0 364.83 
0 1226.17 291.792 
0 0 1 ]
mean reprojection error (in pixels): 0.430366
use new K 
[1226.171286792582, 0, 364.8304270460639;
  0, 1226.171286792582, 291.7924459372023;
  0, 0, 1]
after 5 map size: 10723
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 21757
train frame keypoints: 22343
match size: 21757-----------------------------------------------------------------
found 5337 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 5337
2d point: 5337
inliers size: 3940
projected point: 5337
--------------------------------------------------------------------------
(3940/5337)
found t = [5.543324232805054; 4.42475061489348; 2.656947407415323]
R = 
[0.9942199662213055, 0.09295654795212023, -0.05371907444969086;
  -0.09677442625291875, 0.9925902063189495, -0.07348056030763323;
  0.04649052796349648, 0.07825447279568437, 0.9958488179925429]
frame pose [0.9942199662213055, 0.09295654795212023, -0.05371907444969086, 5.543324232805054;
  -0.09677442625291875, 0.9925902063189495, -0.07348056030763323, 4.42475061489348;
  0.04649052796349648, 0.07825447279568437, 0.9958488179925429, 2.656947407415323]
next to triangulate ,inliers size: 3940
match size: 21757
match size: 3940
begin triangulation
p query index 5
[0.9942199662213055, 0.09295654795212023, -0.05371907444969086, 5.543324232805054;
  -0.09677442625291875, 0.9925902063189495, -0.07348056030763323, 4.42475061489348;
  0.04649052796349648, 0.07825447279568437, 0.9958488179925429, 2.656947407415323]
p train index 4
[0.9954768207119905, 0.08161909218121344, -0.04862327854702597, 5.115023849764063;
  -0.08533333968036301, 0.9931380834125227, -0.07996854640855144, 4.561506040293008;
  0.04176266950450943, 0.08375602108037032, 0.9956107715210004, 2.262874173895687]
getalign
triangulate points
Triangulating...Done. (3940points, 0.34633s, mean reproj err = 14.1864)
triangulation reproj error 14.1864
test triangulate
3931/3940 = 99.7716% are in front of camera
3914/3940 = 99.3401% are in front of camera
filtered out 49 high-error points
3113/3891 points were found in other views, adding 778 new
before triangulation: 11501 after 11501
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 3891 K (measurements) = 7782
intrinsic before bundle = [ 1226.17 0 364.83 
0 1226.17 291.792 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 7782 valid 2D measurements.
mean reprojection error (in pixels): 1.49044
K0 = [ 1 0 0.297536 
0 1 0.23797 
0 0 1 ]
optimizer status = 0
refined K = [ 1.07345 0 0.232392 
0 1.07345 0.369648 
0 0 1 ]
Knew = [ 1316.23 0 284.952 
0 1316.23 453.252 
0 0 1 ]
mean reprojection error (in pixels): 0.363556
use new K 
[1316.230281717123, 0, 284.9521059021053;
  0, 1316.230281717123, 453.2517186841795;
  0, 0, 1]
after 6 map size: 11501
get color: 
11501  23002
