hello world
=========================== Baseline triangulation ===========================
Find camera matrices...
before fundamentalMat 22551
F keeping 15777 / 22551
22551 matches before, 15777 new matches after Fundamental Matrix
after fundamentalMat 15777
K
[1024, 0, 512;
  0, 1024, 384;
  0, 0, 1]
F
[-6.005156580717589e-006, 0.0001069980404777218, -0.0604743065529005;
  -0.0001050039675964833, -5.624708616866439e-006, 0.2545728318157992;
  0.07329862202154058, -0.2516759626765938, 1]
det(F)
-8.47033e-022
E
[-6.296863066782526, 112.1955772919676, -23.00077995907351;
  -110.1046403264501, -5.897934462639343, 203.4185341926636;
  30.62011729424752, -203.8301225583379, 6.666885149928895]
----------------------- SVD ------------------------
U:
[0.443813769828018, 0.1977144089715506, -0.8740356687207185;
  -0.5375525617559032, 0.8391216149761328, -0.08313939276608173;
  -0.7169843659806739, -0.5067385201115832, -0.4786956143254433]
W:
[237.2535753865256; 230.0716197224092; 1.661581393366265e-014]
Vt:
[0.1451537726770203, 0.8392177136269201, -0.5240648923677609;
  -0.474428602805282, 0.5238463256223418, 0.7074620328838852;
  0.8682441379691867, 0.1459405915664871, 0.4741871577925408]
----------------------------------------------------
singular value ratio: 0.969729
det(R) == -1 [-1]: flip E's sign
----------------------- SVD ------------------------
U:
[-0.443813769828018, -0.1977144089715506, 0.8740356687207185;
  0.5375525617559032, -0.8391216149761328, 0.08313939276608173;
  0.7169843659806739, 0.5067385201115832, 0.4786956143254433]
W:
[237.2535753865256; 230.0716197224092; 1.661581393366265e-014]
Vt:
[0.1451537726770203, 0.8392177136269201, -0.5240648923677609;
  -0.474428602805282, 0.5238463256223418, 0.7074620328838852;
  0.8682441379691867, 0.1459405915664871, 0.4741871577925408]
----------------------------------------------------
singular value ratio: 0.969729
P
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
Testing P1 
[0.5196194066426623, 0.1941220608801162, 0.8320530618416016, 0.8740356687207185;
  0.2054139330631017, -0.9736672453171452, 0.09887978307050324, 0.08313939276608173;
  0.8293375599500333, 0.1195354377420297, -0.5458117722987902, 0.4786956143254433]
test branch 1
Triangulating...Done. (15777points, 1.36292s, mean reproj err = 5.92309)
Triangulating...Done. (15777points, 1.35529s, mean reproj err = 6.01075)
15777/15777 = 100% are in front of camera
0/15777 = 0% are in front of camera
P
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
Testing P1 
[0.5196194066426623, 0.1941220608801162, 0.8320530618416016, -0.8740356687207185;
  0.2054139330631017, -0.9736672453171452, 0.09887978307050324, -0.08313939276608173;
  0.8293375599500333, 0.1195354377420297, -0.5458117722987902, -0.4786956143254433]
test branch 2
Triangulating...Done. (15777points, 1.30588s, mean reproj err = 5.92309)
Triangulating...Done. (15777points, 1.30135s, mean reproj err = 6.01075)
0/15777 = 0% are in front of camera
P
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
Testing P1 
[0.9981332848428213, 0.06099250420650737, -0.00314008272164118, 0.8740356687207185;
  -0.0610433522561652, 0.9979340696426663, -0.0200325183578112, 0.08313939276608173;
  0.001911762069216172, 0.02018680452784669, 0.9997943979082627, 0.4786956143254433]
test branch 3
Triangulating...Done. (15777points, 1.30037s, mean reproj err = 6.55657)
Triangulating...Done. (15777points, 1.30843s, mean reproj err = 6.67507)
15657/15777 = 99.2394% are in front of camera
15657/15777 = 99.2394% are in front of camera
Done. (8.75113s)
begin triangulation
p query index 1
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
p train index 0
[0.9981332848428213, 0.06099250420650737, -0.00314008272164118, 0.8740356687207185;
  -0.0610433522561652, 0.9979340696426663, -0.0200325183578112, 0.08313939276608173;
  0.001911762069216172, 0.02018680452784669, 0.9997943979082627, 0.4786956143254433]
getalign
triangulate points
Triangulating...Done. (15777points, 1.35759s, mean reproj err = 6.55657)
triangulation reproj error 6.55657
test triangulate
15657/15777 = 99.2394% are in front of camera
15657/15777 = 99.2394% are in front of camera
filtered out 127 high-error points
3007/15650 points were found in other views, adding 12643 new
 after 12643
after init map size: 12643
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 22138
train frame keypoints: 22551
match size: 22138
-----------------------------------------------------------------
found 18278 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 18278
2d point: 18278
inliers size: 11404
projected point: 18278
--------------------------------------------------------------------------
(11404/18278)
found t = [-1.018653042638136; -0.2672281889586959; 0.1280332546771632]
R = 
[0.9991767577908661, 0.02779103794543123, 0.02955443960640256;
  -0.02749256618044804, 0.9995673011446884, -0.01045797720104531;
  -0.02983228947544219, 0.009636840365986176, 0.9995084621014541]
frame pose [0.9991767577908661, 0.02779103794543123, 0.02955443960640256, -1.018653042638136;
  -0.02749256618044804, 0.9995673011446884, -0.01045797720104531, -0.2672281889586959;
  -0.02983228947544219, 0.009636840365986176, 0.9995084621014541, 0.1280332546771632]
next to triangulate ,inliers size: 11404
match size: 22138
match size: 11404
begin triangulation
p query index 2
[0.9991767577908661, 0.02779103794543123, 0.02955443960640256, -1.018653042638136;
  -0.02749256618044804, 0.9995673011446884, -0.01045797720104531, -0.2672281889586959;
  -0.02983228947544219, 0.009636840365986176, 0.9995084621014541, 0.1280332546771632]
p train index 1
[1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0]
getalign
triangulate points
Triangulating...Done. (11404points, 0.998831s, mean reproj err = 121.028)
triangulation reproj error 121.028
test triangulate
10225/11404 = 89.6615% are in front of camera
10209/11404 = 89.5212% are in front of camera
filtered out 2325 high-error points
8471/9079 points were found in other views, adding 608 new
before triangulation: 13251 after 13251
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 9079 K (measurements) = 18158
intrinsic before bundle = [ 1024 0 512 
0 1024 384 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 18158 valid 2D measurements.
mean reprojection error (in pixels): 6.05129
K0 = [ 1 0 0.5 
0 1 0.375 
0 0 1 ]
optimizer status = 0
refined K = [ 0.942784 0 0.465173 
0 0.942784 0.411181 
0 0 1 ]
Knew = [ 965.41 0 476.337 
0 965.41 421.05 
0 0 1 ]
mean reprojection error (in pixels): 0.599687
use new K 
[965.4103514311978, 0, 476.3366921126524;
  0, 965.4103514311978, 421.0495425517865;
  0, 0, 1]
after 2 map size: 13251
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 20621
train frame keypoints: 22138
match size: 20621
-----------------------------------------------------------------
found 11099 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 11099
2d point: 11099
inliers size: 4713
projected point: 11099
--------------------------------------------------------------------------
(4713/11099)
found t = [-0.5729240718340475; -0.808600921111716; -1.696051812112959]
R = 
[0.9976251084826208, 0.0436668289136607, 0.05326679057033843;
  -0.04197052957307233, 0.9985881891087401, -0.03255922634036164;
  -0.0546133461014345, 0.03024626630101844, 0.9980493704233537]
frame pose [0.9976251084826208, 0.0436668289136607, 0.05326679057033843, -0.5729240718340475;
  -0.04197052957307233, 0.9985881891087401, -0.03255922634036164, -0.808600921111716;
  -0.0546133461014345, 0.03024626630101844, 0.9980493704233537, -1.696051812112959]
next to triangulate ,inliers size: 4713
match size: 20621
match size: 4713
begin triangulation
p query index 3
[0.9976251084826208, 0.0436668289136607, 0.05326679057033843, -0.5729240718340475;
  -0.04197052957307233, 0.9985881891087401, -0.03255922634036164, -0.808600921111716;
  -0.0546133461014345, 0.03024626630101844, 0.9980493704233537, -1.696051812112959]
p train index 2
[0.9989533086778679, 0.04064462236861061, 0.02098336851061398, 0.3020511233035771;
  -0.04038206040313951, 0.9991024666308266, -0.01278868131567917, -1.194870733131754;
  -0.02148432635984644, 0.01192794385926758, 0.9996980283446371, -1.96470150596164]
getalign
triangulate points
Triangulating...Done. (4713points, 0.414621s, mean reproj err = 44.9607)
triangulation reproj error 44.9607
test triangulate
4572/4713 = 97.0083% are in front of camera
4566/4713 = 96.881% are in front of camera
filtered out 364 high-error points
3733/4349 points were found in other views, adding 616 new
before triangulation: 13867 after 13867
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 4349 K (measurements) = 8698
intrinsic before bundle = [ 965.41 0 476.337 
0 965.41 421.05 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 8698 valid 2D measurements.
mean reprojection error (in pixels): 1.81617
K0 = [ 1 0 0.493403 
0 1 0.436135 
0 0 1 ]
optimizer status = 0
refined K = [ 0.871265 0 0.496599 
0 0.871265 0.430448 
0 0 1 ]
Knew = [ 841.128 0 479.422 
0 841.128 415.559 
0 0 1 ]
mean reprojection error (in pixels): 0.352988
use new K 
[841.1283941474668, 0, 479.4220809989177;
  0, 841.1283941474668, 415.5588857944419;
  0, 0, 1]
after 3 map size: 13867
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 22600
train frame keypoints: 20621
match size: 22600
-----------------------------------------------------------------
found 6295 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 6295
2d point: 6295
inliers size: 4274
projected point: 6295
--------------------------------------------------------------------------
(4274/6295)
found t = [-1.233157392301508; -0.5007497626994879; -7.034134825025973]
R = 
[0.9953201107271402, 0.05805049854170014, 0.07725294040470856;
  -0.05486275392303072, 0.9975775980148122, -0.04276697523766252;
  -0.07954844696217744, 0.03832852146976103, 0.9960938555316199]
frame pose [0.9953201107271402, 0.05805049854170014, 0.07725294040470856, -1.233157392301508;
  -0.05486275392303072, 0.9975775980148122, -0.04276697523766252, -0.5007497626994879;
  -0.07954844696217744, 0.03832852146976103, 0.9960938555316199, -7.034134825025973]
next to triangulate ,inliers size: 4274
match size: 22600
match size: 4274
begin triangulation
p query index 4
[0.9953201107271402, 0.05805049854170014, 0.07725294040470856, -1.233157392301508;
  -0.05486275392303072, 0.9975775980148122, -0.04276697523766252, -0.5007497626994879;
  -0.07954844696217744, 0.03832852146976103, 0.9960938555316199, -7.034134825025973]
p train index 3
[0.9979596003048531, 0.04491333220032949, 0.0453809293651081, -0.5051710823433018;
  -0.04398041328706896, 0.9988042041156223, -0.02135146571215964, -0.6442561381155036;
  -0.04628562850903822, 0.01931202815920084, 0.9987415512343031, -7.090498469379138]
getalign
triangulate points
Triangulating...Done. (4274points, 0.371307s, mean reproj err = 95.5454)
triangulation reproj error 95.5454
test triangulate
4097/4274 = 95.8587% are in front of camera
4094/4274 = 95.7885% are in front of camera
filtered out 338 high-error points
2411/3936 points were found in other views, adding 1525 new
before triangulation: 15392 after 15392
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 3936 K (measurements) = 7872
intrinsic before bundle = [ 841.128 0 479.422 
0 841.128 415.559 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 7872 valid 2D measurements.
mean reprojection error (in pixels): 1.07987
K0 = [ 1 0 0.569975 
0 1 0.494049 
0 0 1 ]
optimizer status = 0
refined K = [ 0.946305 0 0.547423 
0 0.946305 0.486345 
0 0 1 ]
Knew = [ 795.964 0 460.453 
0 795.964 409.079 
0 0 1 ]
mean reprojection error (in pixels): 0.333741
use new K 
[795.9641301138105, 0, 460.4530429736562;
  0, 795.9641301138105, 409.0785114445303;
  0, 0, 1]
after 4 map size: 15392
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 22170
train frame keypoints: 22600
match size: 22170
-----------------------------------------------------------------
found 5269 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 5269
2d point: 5269
inliers size: 1406
projected point: 5269
--------------------------------------------------------------------------
(1406/5269)
found t = [-1.448051122528132; 0.3560319074039291; -10.27722467923157]
R = 
[0.9931305017401761, 0.06358721079386154, 0.09822664168525284;
  -0.06084169011214108, 0.9976751703168688, -0.03070086769954411;
  -0.09995046401895404, 0.02451369324813654, 0.9946903958447232]
frame pose [0.9931305017401761, 0.06358721079386154, 0.09822664168525284, -1.448051122528132;
  -0.06084169011214108, 0.9976751703168688, -0.03070086769954411, 0.3560319074039291;
  -0.09995046401895404, 0.02451369324813654, 0.9946903958447232, -10.27722467923157]
next to triangulate ,inliers size: 1406
match size: 22170
match size: 1406
begin triangulation
p query index 5
[0.9931305017401761, 0.06358721079386154, 0.09822664168525284, -1.448051122528132;
  -0.06084169011214108, 0.9976751703168688, -0.03070086769954411, 0.3560319074039291;
  -0.09995046401895404, 0.02451369324813654, 0.9946903958447232, -10.27722467923157]
p train index 4
[0.9958542815766337, 0.05891238807438207, 0.06930786677470176, -0.7869053263084173;
  -0.05634736552996816, 0.9976724544154709, -0.0384011470979883, 0.3148080593444861;
  -0.07140885283575532, 0.03433663105172932, 0.9968559432057871, -11.01664256228866]
getalign
triangulate points
Triangulating...Done. (1406points, 0.121622s, mean reproj err = 46.0654)
triangulation reproj error 46.0654
test triangulate
1370/1406 = 97.4395% are in front of camera
1340/1406 = 95.3058% are in front of camera
filtered out 99 high-error points
1103/1307 points were found in other views, adding 204 new
before triangulation: 15596 after 15596
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 1307 K (measurements) = 2614
intrinsic before bundle = [ 795.964 0 460.453 
0 795.964 409.079 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 2614 valid 2D measurements.
mean reprojection error (in pixels): 1.97165
K0 = [ 1 0 0.578485 
0 1 0.513941 
0 0 1 ]
optimizer status = 0
refined K = [ 1.0076 0 0.633044 
0 1.0076 0.490801 
0 0 1 ]
Knew = [ 802.014 0 503.88 
0 802.014 390.66 
0 0 1 ]
mean reprojection error (in pixels): 0.328677
use new K 
[802.0142442444097, 0, 503.8804905321888;
  0, 802.0142442444097, 390.6601162692228;
  0, 0, 1]
after 5 map size: 15596
-----------------------------------------------------------------
find 2d 3d correspondences
query frame keypoints: 21559
train frame keypoints: 22170
match size: 21559
-----------------------------------------------------------------
found 1687 3d-2d point correspondences
-------------------------------------------------------------------------
find pose estimation
3d point: 1687
2d point: 1687
inliers size: 1259
projected point: 1687
--------------------------------------------------------------------------
(1259/1687)
found t = [-2.734225311765379; 0.2753092639189116; -9.516431924405751]
R = 
[0.9892920568425349, 0.08036736494517009, 0.1218290315156312;
  -0.07890357169441283, 0.9967406791935474, -0.01680014329256035;
  -0.1227821348655067, 0.007007502590491857, 0.9924089087998519]
frame pose [0.9892920568425349, 0.08036736494517009, 0.1218290315156312, -2.734225311765379;
  -0.07890357169441283, 0.9967406791935474, -0.01680014329256035, 0.2753092639189116;
  -0.1227821348655067, 0.007007502590491857, 0.9924089087998519, -9.516431924405751]
next to triangulate ,inliers size: 1259
match size: 21559
match size: 1259
begin triangulation
p query index 6
[0.9892920568425349, 0.08036736494517009, 0.1218290315156312, -2.734225311765379;
  -0.07890357169441283, 0.9967406791935474, -0.01680014329256035, 0.2753092639189116;
  -0.1227821348655067, 0.007007502590491857, 0.9924089087998519, -9.516431924405751]
p train index 5
[0.9924996177999246, 0.07230520976052718, 0.09857213251466872, -2.311393665025454;
  -0.07103648703207707, 0.9973401167880479, -0.01632510200104481, 0.259978078269299;
  -0.09949033207877429, 0.009200439483479235, 0.9949959928241752, -9.849543383977148]
getalign
triangulate points
Triangulating...Done. (1259points, 0.110447s, mean reproj err = 42.3179)
triangulation reproj error 42.3179
test triangulate
1222/1259 = 97.0612% are in front of camera
1200/1259 = 95.3137% are in front of camera
filtered out 100 high-error points
585/1159 points were found in other views, adding 574 new
before triangulation: 16170 after 16170
======================== Bundle Adjustment ==========================
N (cams) = 2 M (points) = 1159 K (measurements) = 2318
intrinsic before bundle = [ 802.014 0 503.88 
0 802.014 390.66 
0 0 1 ]
Read the 3D points.
Read the cameras.
Read 2318 valid 2D measurements.
mean reprojection error (in pixels): 0.768771
K0 = [ 1 0 0.628269 
0 1 0.487099 
0 0 1 ]
optimizer status = 0
refined K = [ 0.984035 0 0.651154 
0 0.984035 0.461559 
0 0 1 ]
Knew = [ 789.21 0 522.235 
0 789.21 370.177 
0 0 1 ]
mean reprojection error (in pixels): 0.29983
use new K 
[789.2103339146235, 0, 522.2349412608439;
  0, 789.2103339146235, 370.1772695807806;
  0, 0, 1]
after 6 map size: 16170
get color: 
16170  32340
